# Замена изображений на видео в боте SferaTC

## Обзор

В боте SferaTC все изображения были заменены на короткие видео без звука, которые автоматически проигрываются и зацикливаются.

## Технические требования к видео

- Формат: MP4
- Без звука (no audio track)
- Маленький размер (до 20MB для ботов)
- Короткая продолжительность (рекомендуется 3-10 секунд)
- Поддержка зацикливания (loop)
- Автоматическое воспроизведение в Telegram
- Правильные кодеки: H.264 для видео, без аудио
- Максимальное разрешение: 1920x1920 (Telegram автоматически масштабирует)
- Правильный fps (рекомендуется 25-30)

## Используемые переменные окружения

Теперь используются отдельные переменные для изображений и видео:

### Для изображений:
- `WELCOME_IMAGE_URL` - изображение для приветственного сообщения
- `TRAINING_IMAGE_URL` - изображение для раздела обучения
- `PSYCHOLOGIST_IMAGE_URL` - изображение для раздела психолога
- `CHATGPT_IMAGE_URL` - изображение для раздела ChatGPT
- `SUPPORT_IMAGE_URL` - изображение для раздела поддержки
- `TOOLS_IMAGE_URL` - изображение для раздела инструментов

### Для видео:
- `WELCOME_VIDEO_URL` - видео для приветственного сообщения
- `TRAINING_VIDEO_URL` - видео для раздела обучения
- `PSYCHOLOGIST_VIDEO_URL` - видео для раздела психолога
- `CHATGPT_VIDEO_URL` - видео для раздела ChatGPT
- `SUPPORT_VIDEO_URL` - видео для раздела поддержки
- `TOOLS_VIDEO_URL` - видео для раздела инструментов

## Универсальная функция

Для отправки видео с fallback к изображению или тексту используется универсальная функция:

```python
from config import send_video_or_photo_fallback

# В обычном режиме (reply)
await send_video_or_photo_fallback(
    message=update.message,
    video_url=video_url,
    photo_url=photo_url,
    caption="Текст сообщения",
    reply_markup=keyboard
)

# В inline-режиме (редактирование сообщения)
await send_video_or_photo_fallback(
    query=query,
    video_url=video_url,
    photo_url=photo_url,
    caption="Текст сообщения",
    reply_markup=keyboard,
    parse_mode='Markdown'  # опционально
)
```

Функция автоматически:
1. Пробует отправить/редактировать видео
2. При ошибке отправляет/редактирует изображение
3. При ошибке отправляет/редактирует только текст

## Вспомогательная функция

Для удобного получения пар видео/изображение по базовому имени используется вспомогательная функция:

```python
from config import get_video_or_photo_urls

# Получаем пару URL для определенного раздела
video_url, photo_url = get_video_or_photo_urls(settings, "CHATGPT")
# вернет: settings.CHATGPT_VIDEO_URL, settings.CHATGPT_IMAGE_URL
```

## Поддерживаемые сценарии

1. **reply_animation/reply_photo** - отправка нового сообщения с анимацией/изображением
2. **edit_message_media** - замена медиа в inline-режиме
3. **edit_message_caption/edit_message_text** - редактирование только текста при ошибках

## Тестирование

Для тестирования функциональности:
1. Убедитесь, что URL видео доступны и соответствуют требованиям
2. Проверьте, что видео проигрывается в различных клиентах Telegram
3. Убедитесь, что fallback к изображению работает при ошибках
4. Проверьте inline-редактирование медиа

## Важное замечание об автоматическом воспроизведении

Telegram автоматически определяет, будет ли видео проигрываться автономно, на основе его технических характеристик:
- Видео должно быть в формате MP4 с кодеком H.264
- Размер файла не должен быть слишком большим
- Длительность видео должна быть короткой (до 10-15 секунд)
- Видео не должно содержать аудиодорожку
- Разрешение и соотношение сторон должны соответствовать стандартным

Если видео не соответствует этим требованиям, оно будет отображаться с кнопкой "Плей" и пользователь должен будет запустить его вручную.