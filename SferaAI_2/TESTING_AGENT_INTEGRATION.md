# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –°–∏—Å—Ç–µ–º—ã –ü–µ—Ä—Å–æ–Ω –≤ –ê–≥–µ–Ω—Ç–µ

## ‚úÖ –ß—Ç–æ –£–∂–µ –°–¥–µ–ª–∞–Ω–æ

1. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `determine_persona(query)` –≤ `agent.py` (—Å—Ç—Ä–æ–∫–∏ 33-72)
2. ‚úÖ –ê–≥–µ–Ω—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å —Ä–æ–ª—å—é `"partner"` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—Å—Ç—Ä–æ–∫–∞ 128)
3. ‚úÖ `get_system_prompt(persona=current_persona)` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–º–ø—Ç–∞ (—Å—Ç—Ä–æ–∫–∞ 129)

## üß™ –ö–∞–∫ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–¥–ª—è –Ω–∞—á–∞–ª–∞)

**–¶–µ–ª—å:** –ü—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∞–≥–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–∞–∂–¥–æ–π —Ä–æ–ª—å—é

1. –û—Ç–∫—Ä–æ–π `agent.py`, –Ω–∞–π–¥–∏ —Å—Ç—Ä–æ–∫—É 128:
   ```python
   current_persona = "partner"  # –ù–∞—á–∞–ª—å–Ω–∞—è —Ä–æ–ª—å
   ```

2. –ü–æ–º–µ–Ω—è–π –Ω–∞ –Ω—É–∂–Ω—É—é —Ä–æ–ª—å:
   ```python
   current_persona = "psychologist"  # –¢–µ—Å—Ç —Ä–æ–ª–∏ –ø—Å–∏—Ö–æ–ª–æ–≥–∞
   ```
   –∏–ª–∏
   ```python
   current_persona = "mentor"  # –¢–µ—Å—Ç —Ä–æ–ª–∏ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–∞
   ```

3. –ó–∞–ø—É—Å—Ç–∏ –∞–≥–µ–Ω—Ç–∞:
   ```bash
   python agent.py
   ```

4. –ü–æ–¥–∫–ª—é—á–∏—Å—å –∏ –∑–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å—ã:
   - **Partner:** "–ö–∞–∫ –¥—É–º–∞–µ—à—å, —Å—Ç–æ–∏—Ç –≤—Ö–æ–¥–∏—Ç—å –≤ BTC?"
   - **Mentor:** "–û–±—ä—è—Å–Ω–∏ —á—Ç–æ —Ç–∞–∫–æ–µ RSI –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä"
   - **Psychologist:** "–Ø –≤ —Ç–∏–ª—å—Ç–µ, —Ö–æ—á—É –æ—Ç—ã–≥—Ä–∞—Ç—å—Å—è"

5. **–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
   - **Partner** ü§ù: –î—Ä—É–∂–µ—Å–∫–∏–π —Ç–æ–Ω, "–°–ª—É—à–∞–π...", "–ß—Ç–æ –¥—É–º–∞–µ—à—å?"
   - **Mentor** üë®‚Äçüè´: "–î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä–µ–º –ø–æ—à–∞–≥–æ–≤–æ...", "–ü–æ–Ω—è—Ç–Ω–æ –æ–±—ä—è—Å–Ω–∏–ª–∞?"
   - **Psychologist** üß†: "–ö–∞–∫ —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—à—å?", "–î–∞–≤–∞–π –æ—Å—Ç–∞–Ω–æ–≤–∏–º—Å—è..."

### –í–∞—Ä–∏–∞–Ω—Ç 2: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ (–±—É–¥—É—â–µ–µ)

**–í–ê–ñ–ù–û:** –°–µ–π—á–∞—Å —Ä–æ–ª—å –ù–ï –º–µ–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –§—É–Ω–∫—Ü–∏—è `determine_persona()` —Å–æ–∑–¥–∞–Ω–∞, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ runtime.

–î–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–æ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## üìä –¢–µ—Å—Ç–æ–≤—ã–µ –°—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: Partner mode
```
User: "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?"
Expected: –î—Ä—É–∂–µ—Å–∫–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ–±—Å—É–¥–∏—Ç—å —Ä—ã–Ω–∫–∏

User: "–î–∞–≤–∞–π –æ–±—Å—É–¥–∏–º BTC?"
Expected: "–°–ª—É—à–∞–π, —á—Ç–æ –¥—É–º–∞–µ—à—å —Å–∞–º?", —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: Mentor mode
```
User: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Å—Ç–æ–ø-–ª–æ—Å—Å?"
Expected: 
- –ß–µ—Ç–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
- –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ
- –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –í–æ–ø—Ä–æ—Å "–ü–æ–Ω—è—Ç–Ω–æ –æ–±—ä—è—Å–Ω–∏–ª–∞?"
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: Psychologist mode
```
User: "–Ø –ø–æ—Ç–µ—Ä—è–ª –¥–µ–Ω—å–≥–∏ –∏ –æ—á–µ–Ω—å –∑–ª–æ–π"
Expected:
- "–ü–æ–Ω–∏–º–∞—é —Ç–≤–æ–∏ —á—É–≤—Å—Ç–≤–∞..."
- –¢–µ—Ö–Ω–∏–∫–∏ —É—Å–ø–æ–∫–æ–µ–Ω–∏—è
- –†–∞–±–æ—Ç–∞ —Å —ç–º–æ—Ü–∏–µ–π
- –ù–ï —Å–æ–≤–µ—Ç—ã –ø–æ —Ç—Ä–µ–π–¥–∏–Ω–≥—É!
```

## üîç –ß—Ç–æ –ü—Ä–æ–≤–µ—Ä—è—Ç—å

### –í –ª–æ–≥–∞—Ö –∞–≥–µ–Ω—Ç–∞
–î–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∏–¥–Ω–æ:
```
INFO:root:Loaded modular prompt for persona 'partner' (8116 chars)
```

–ò–ª–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–æ–ª–µ–π:
```
INFO:root:Loaded modular prompt for persona 'mentor' (9072 chars)
INFO:root:Loaded modular prompt for persona 'psychologist' (11436 chars)
```

### –í –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –∞–≥–µ–Ω—Ç–∞

**Partner:**
- ‚úÖ –û–±—Ä–∞—â–∞–µ—Ç—Å—è –¥—Ä—É–∂–µ—Å–∫–∏
- ‚úÖ –°–ø—Ä–∞—à–∏–≤–∞–µ—Ç –º–Ω–µ–Ω–∏–µ
- ‚úÖ –û–±—Å—É–∂–¥–∞–µ—Ç, –∞ –Ω–µ —É—á–∏—Ç
- ‚úÖ –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∏–¥–µ–∏

**Mentor:**
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ
- ‚úÖ –î–∞–µ—Ç –ø—Ä–∏–º–µ—Ä—ã
- ‚úÖ –¢–µ—Ä–ø–µ–ª–∏–≤—ã–π

**Psychologist:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å —ç–º–æ—Ü–∏—è–º–∏
- ‚úÖ –¢–µ—Ö–Ω–∏–∫–∏ —É—Å–ø–æ–∫–æ–µ–Ω–∏—è
- ‚úÖ –≠–º–ø–∞—Ç–∏—á–Ω—ã–π
- ‚úÖ –ù–µ –æ—Å—É–∂–¥–∞–µ—Ç

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–†–æ–ª—å –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** - –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –º–µ–Ω—è—Ç—å –≤ –∫–æ–¥–µ
2. **–§—É–Ω–∫—Ü–∏—è `determine_persona()` —Å–æ–∑–¥–∞–Ω–∞ –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** - –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. **–ü–∞—Ä–∞–º–µ—Ç—Ä `persona` –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ `search_knowledge_base`** - –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–î–æ–±–∞–≤–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ:**
   - –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –æ—Ç–≤–µ—Ç–æ–º
   - –ú–µ–Ω—è—Ç—å `current_persona` –Ω–∞ –æ—Å–Ω–æ–≤–µ `determine_persona(user_query)`

2. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å knowledge_base:**
   - –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å `persona` –≤ –≤—ã–∑–æ–≤—ã `search_knowledge_base`
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–æ–ª–∏ –º–µ–∂–¥—É –ø—Ä–æ–º–ø—Ç–æ–º –∏ KB

3. **–î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–æ–ª–∏ –≤ UI:**
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ç–µ–∫—É—â—É—é —Ä–æ–ª—å –∞–≥–µ–Ω—Ç–∞
   - –í–∏–∑—É–∞–ª—å–Ω—ã–µ –æ—Ç–ª–∏—á–∏—è (—Ü–≤–µ—Ç, –∏–∫–æ–Ω–∫–∞)

## üí° –ë—ã—Å—Ç—Ä—ã–π –¢–µ—Å—Ç

```bash
# 1. –£–±–µ–¥–∏—Å—å —á—Ç–æ –º–æ–¥—É–ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
ls prompts/personas/

# 2. –ü—Ä–æ–≤–∞–ª–∏–¥–∏—Ä—É–π –ø—Ä–æ–º–ø—Ç—ã
python test_prompts.py

# 3. –ò–∑–º–µ–Ω–∏ —Ä–æ–ª—å –≤ agent.py (—Å—Ç—Ä–æ–∫–∞ 128)
# current_persona = "psychologist"

# 4. –ó–∞–ø—É—Å—Ç–∏ –∞–≥–µ–Ω—Ç–∞
python agent.py

# 5. –ó–∞–¥–∞–π —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å
# "–Ø –≤ —Ç–∏–ª—å—Ç–µ"

# 6. –°–ª—É—à–∞–π –æ—Ç–≤–µ—Ç - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —ç–º–ø–∞—Ç–∏—á–Ω—ã–º!
```

## üìù –ß–µ–∫-–ª–∏—Å—Ç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- [ ] –ê–≥–µ–Ω—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ "Loaded modular prompt for persona '...'"
- [ ] Partner –æ—Ç–≤–µ—á–∞–µ—Ç –¥—Ä—É–∂–µ—Å–∫–∏
- [ ] Mentor –¥–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è
- [ ] Psychologist —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —ç–º–æ—Ü–∏—è–º–∏
- [ ] –¢–æ–Ω –∏ —Å—Ç–∏–ª—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ä–æ–ª–∏
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ–º–ø—Ç–æ–≤

## üêõ Troubleshooting

**–ü—Ä–æ–±–ª–µ–º–∞:** –ê–≥–µ–Ω—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å –∏–º–ø–æ—Ä—Ç—ã
python -c "from prompts import get_system_prompt; print('OK')"
```

**–ü—Ä–æ–±–ª–µ–º–∞:** Tone –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –¥–ª—è –≤—Å–µ—Ö —Ä–æ–ª–µ–π
```bash
# –£–±–µ–¥–∏—Å—å —á—Ç–æ –ø—Ä–æ–º–ø—Ç—ã —Ä–∞–∑–Ω—ã–µ
python -c "from prompts import get_system_prompt; p1=get_system_prompt('partner'); p2=get_system_prompt('mentor'); print('Different' if p1!=p2 else 'SAME')"
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ –ø—Ä–∏ import prompts
```bash
# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ prompts/__init__.py —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls prompts/__init__.py
```
